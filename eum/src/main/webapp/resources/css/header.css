/* ========= header.css (SoSoHelp 공통 헤더) ========= */
:root{
  --bg:#FFF8F2; --text:#222; --muted:#6b7280;
  --primary:#F6A96D; --primary-600:#e98c45;
  --brand:#FFE8C2; --brand-200:#FADFCB;
  --card:#FFFFFF; --card-br:#FFE1CB;
  --maxw:1100px; --radius:16px; --shadow-soft:0 6px 18px rgba(0,0,0,.06);
  --header-h:72px;
}
@media (max-width:900px){ :root{ --header-h:64px; } }

/* 초기화 & 본문 보정 */
html,body{ margin:0 !important; }
body{ padding-top:var(--header-h) !important; }

/* ===== 헤더 ===== */
[data-eum-header]{
  position:fixed !important; top:0 !important; left:0; right:0;
  height:var(--header-h);
  background:var(--card);
  border-bottom:1px solid var(--brand-200);
  box-shadow:var(--shadow-soft);
  transform:none !important; -webkit-transform:none !important;
  z-index:2147483647 !important;
}
#header.header-fixed-root{ position:fixed !important; top:0 !important; }

[data-eum-header] .eum-container{
  height:100%;
  max-width:var(--maxw); margin:0 auto; padding:0 16px;
  display:flex; align-items:center;
}
[data-eum-header] .eum-header-row{
  display:grid; grid-template-columns:1fr auto 1fr;
  align-items:center; width:100%; gap:12px;
}

/* 좌측 */
[data-eum-header] .eum-left{ display:flex; align-items:center; gap:12px; min-width:0; }
[data-eum-header] .eum-hamburger,
#hamburger{
  display:inline-flex; align-items:center; justify-content:center;
  width:40px; height:40px; border-radius:10px; border:1px solid var(--card-br);
  background:#fff; color:var(--text); font-size:18px; line-height:1; cursor:pointer;
}
[data-eum-header] .eum-hamburger:hover,#hamburger:hover{ background:var(--brand); }

/* 상단 내비 */
[data-eum-header] .eum-topnav{ display:flex; align-items:center; gap:10px; min-width:0; }
[data-eum-header] .eum-topnav a{
  display:inline-flex; align-items:center;
  height:40px; padding:0 10px;
  color:var(--text); text-decoration:none; border-radius:10px; font-weight:600;
}
[data-eum-header] .eum-topnav a:hover{ background:var(--brand); }
[data-eum-header] .eum-topnav a.active{ background:var(--primary); color:#fff; }

/* 로고 */
[data-eum-header] .eum-logo{ margin:0; text-align:center; font-size:20px; line-height:1; }
[data-eum-header] .eum-logo a{ display:inline-flex; align-items:center; height:40px; text-decoration:none; color:var(--text); font-weight:800; }

/* 우측 */
[data-eum-header] .eum-right{
  display:flex; align-items:center; justify-content:flex-end; gap:10px; min-width:0; white-space:nowrap;
  padding-right:max(8px, env(safe-area-inset-right, 0px));
}
[data-eum-header] .sep{ color:var(--muted); opacity:.7; user-select:none; pointer-events:none; margin:0 2px; }
[data-eum-header] .user-points,
[data-eum-header] .user-name{
  display:inline-flex; align-items:center;
  height:40px; text-decoration:none; color:var(--text);
}
[data-eum-header] .user-points{ font-weight:800; color:var(--primary-600); }
[data-eum-header] .user-name{ max-width:14ch; overflow:hidden; text-overflow:ellipsis; }
[data-eum-header] .user-name:hover,[data-eum-header] .user-points:hover{ text-decoration:underline; }

[data-eum-header] .auth-btn{
  display:inline-flex; align-items:center; height:40px; padding:0 12px;
  border:1px solid var(--card-br); background:#fff; color:var(--text);
  border-radius:10px; font-weight:700; cursor:pointer; text-decoration:none;
}
[data-eum-header] .auth-btn:hover{ background:var(--brand); }
[data-eum-header] .auth-btn.btn-ghost{ background:transparent; border-color:transparent; padding:0 10px; }
[data-eum-header] .auth-btn.btn-ghost:hover{ background:#00000008; }

/* 알림 버튼 */
[data-eum-header] .icon-btn{
  position:relative; display:inline-flex; align-items:center; justify-content:center;
  width:34px; height:34px; border-radius:50%; border:1px solid var(--card-br); background:#fff; cursor:pointer;
}
[data-eum-header] .icon-btn:hover{ background:var(--brand); }
[data-eum-header] #notifyBadge{
  position:absolute; top:-4px; right:-4px; min-width:16px; height:16px; padding:0 4px;
  border-radius:999px; background:#ff4d4f; color:#fff; font-size:11px;
  display:inline-flex; align-items:center; justify-content:center; box-shadow:0 0 0 2px #fff;
}

/* ===== 드로어 ===== */
.eum-drawer-backdrop{
  position:fixed; left:0; right:0; top:var(--header-h);
  height:calc(100dvh - var(--header-h)); background:rgba(0,0,0,.25);
  backdrop-filter:blur(1.5px); -webkit-backdrop-filter:blur(1.5px); z-index:1100;
}
@supports (height:100svh){ .eum-drawer-backdrop{ height:calc(100svh - var(--header-h)); } }

.eum-drawer{
  position:fixed; top:var(--header-h); left:0; width:78%; max-width:300px;
  height:calc(100dvh - var(--header-h)); background:#fff; border-right:1px solid var(--brand-200);
  box-shadow:-10px 0 24px rgba(0,0,0,.08); transform:translateX(-100%); transition:transform .25s ease;
  z-index:1110; display:flex; flex-direction:column;
}
@supports (height:100svh){ .eum-drawer{ height:calc(100svh - var(--header-h)); } }
.eum-drawer.open{ transform:translateX(0); }
.eum-drawer-header{ display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid var(--brand-200); }
#drawerClose{ width:36px; height:36px; border-radius:10px; border:1px solid var(--card-br); background:#fff; cursor:pointer; }
#drawerMenu{ padding:8px 8px 16px; overflow:auto; }
#drawerMenu a{ display:block; padding:12px 10px; border-radius:10px; color:var(--text); text-decoration:none; font-weight:600; }
#drawerMenu a:hover{ background:var(--brand); }

/* 스크롤 잠금 */
html.no-scroll, body.no-scroll{ overflow:hidden; }

/* 포커스 */
a:focus-visible, button:focus-visible{ outline:2px solid var(--primary); outline-offset:2px; border-radius:10px; }

/* 안전망 */
[hidden]{ display:none !important; }

/* 기본 반응형 디테일 */
@media (max-width:900px){
  [data-eum-header] .eum-topnav{ display:none !important; }
  [data-eum-header] .user-name{ max-width:10ch; }
  [data-eum-header] .icon-btn{ width:32px; height:32px; }
}

/* anti-drop hardening */
body > #header[data-eum-header],
#header.header-fixed-root,
[data-eum-header]{
  position:fixed !important; top:0 !important; left:0; right:0;
  transform:none !important; z-index:2147483647 !important;
}

/* =========================================================
   가시성 규칙 (최종 스펙)
   --- 데스크탑(≥901px) ---
   guest:  로그인 | 회원가입
   member: 포인트 | 회원이름 | 알림 | 로그아웃
   --- 모바일(≤900px) ---
   guest:  로그인 | 회원가입
   member: 회원이름 | 알림  (포인트/로그아웃 숨김, 구분선 숨김)
   --- 소형 모바일(≤800px) ---
   guest:  로그인만  (회원가입 숨김)
   member: 회원이름 | 알림  (이름 유지)
   ========================================================= */

/* 데스크탑 기본(≥901px) */
[data-eum-header][data-auth="guest"] .user-points,
[data-eum-header][data-auth="guest"] .user-name,
[data-eum-header][data-auth="guest"] .icon-btn,
[data-eum-header][data-auth="guest"] .logout,
[data-eum-header][data-auth="guest"] a[href*="logout"]{
  display:none !important;
}
[data-eum-header][data-auth="member"] .auth-btn{
  display:none !important; /* 로그인/회원가입 숨김 */
}

/* 모바일(≤900px): member는 포인트/로그아웃 숨김 + 구분선 정리 */
@media (max-width:900px){
  [data-eum-header][data-auth="member"] .user-points,
  [data-eum-header][data-auth="member"] .logout,
  [data-eum-header][data-auth="member"] a[href*="logout"]{
    display:none !important;
  }
  /* 남는 세로바( | ) 제거 */
  [data-eum-header] .sep{ display:none !important; }
}

/* 소형 모바일(≤800px):
   - guest: 회원가입 숨김(로그인만)
   - member: 회원이름 + 알림 유지 (이름 숨기지 않음)
*/
@media (max-width:800px){
  /* guest → 로그인만 */
  [data-eum-header][data-auth="guest"] :is(.auth-btn.signup, .auth-btn.join,
    [data-action="signup"], [data-action="join"],
    a[href*="memberForm"], a[href*="join"], a[href*="signup"]){
    display:none !important;
  }
  /* member → 이름과 알림 모두 노출 보장 */
  [data-eum-header][data-auth="member"] .user-name{
    display:inline-flex !important;
  }
  [data-eum-header][data-auth="member"] .icon-btn{
    display:inline-flex !important;
  }
  /* 구분선은 계속 숨김 */
  [data-eum-header] .sep{ display:none !important; }
}

/* ---- 폴백: data-auth 미지정 시 .user-name 존재하면 member로 추정 ---- */
@supports(selector(:has(*))){
  /* 기본은 로그인/회원가입 표시 */
  [data-eum-header]:not([data-auth]) :is(.auth-btn).login,
  [data-eum-header]:not([data-auth]) :is(.auth-btn).signup,
  [data-eum-header]:not([data-auth]) :is(.auth-btn).join{
    display:inline-flex;
  }
  /* .user-name 있으면 member 처리 → 로그인/회원가입 숨김 */
  [data-eum-header]:has(.user-name):not([data-auth]) .auth-btn{
    display:none !important;
  }
  /* ≤900: 포인트/로그아웃 숨김 + 구분선 숨김 */
  @media (max-width:900px){
    [data-eum-header]:has(.user-name):not([data-auth]) .user-points,
    [data-eum-header]:has(.user-name):not([data-auth]) .logout,
    [data-eum-header]:has(.user-name):not([data-auth]) a[href*="logout"]{
      display:none !important;
    }
    [data-eum-header] .sep{ display:none !important; }
  }
  /* ≤800: 멤버 추정이면 이름+알림 유지, 게스트 추정이면 회원가입류 숨김 */
  @media (max-width:800px){
    [data-eum-header]:has(.user-name):not([data-auth]) .user-name,
    [data-eum-header]:has(.user-name):not([data-auth]) .icon-btn{
      display:inline-flex !important;
    }
    [data-eum-header]:not([data-auth]):not(:has(.user-name)) :is(.auth-btn.signup, .auth-btn.join,
      [data-action="signup"], [data-action="join"],
      a[href*="memberForm"], a[href*="join"], a[href*="signup"]){
      display:none !important;
    }
  }
}

/* 보조: 클래스 힌트(있을 때만) */
[data-eum-header] :is(.auth-btn.logout, [data-action="logout"]){ display:inline-flex; }
[data-eum-header] .auth-btn.login{ display:inline-flex; }
[data-eum-header] .auth-btn.signup,
[data-eum-header] .auth-btn.join{ display:inline-flex; }
